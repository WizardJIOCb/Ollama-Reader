<!DOCTYPE html>
<html>
<head>
    <title>Test Search</title>
</head>
<body>
    <h1>Test Search Functionality</h1>
    <input type="text" id="searchInput" placeholder="Enter search query">
    <button onclick="performSearch()">Search</button>
    <div id="results"></div>

    <script>
        async function performSearch() {
            const query = document.getElementById('searchInput').value;
            const resultsDiv = document.getElementById('results');
            
            resultsDiv.innerHTML = 'Searching...';
            
            try {
                // First, try to login to get a token
                const loginResponse = await fetch('http://localhost:5001/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: 'user1',
                        password: 'password123'
                    })
                });
                
                if (!loginResponse.ok) {
                    resultsDiv.innerHTML = 'Login failed: ' + await loginResponse.text();
                    return;
                }
                
                const loginData = await loginResponse.json();
                const token = loginData.token;
                
                // Now perform the search
                const searchResponse = await fetch(`http://localhost:5001/api/books/search?query=${encodeURIComponent(query)}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!searchResponse.ok) {
                    resultsDiv.innerHTML = 'Search failed: ' + await searchResponse.text();
                    return;
                }
                
                const books = await searchResponse.json();
                resultsDiv.innerHTML = `<h2>Found ${books.length} books:</h2>`;
                
                books.forEach(book => {
                    resultsDiv.innerHTML += `
                        <div style="border: 1px solid #ccc; margin: 10px; padding: 10px;">
                            <h3>${book.title}</h3>
                            <p><strong>Author:</strong> ${book.author}</p>
                            <p><strong>Description:</strong> ${book.description || 'No description'}</p>
                        </div>
                    `;
                });
            } catch (error) {
                resultsDiv.innerHTML = 'Error: ' + error.message;
            }
        }
    </script>
</body>
</html><!DOCTYPE html>
<html>
<head>
    <title>Test Search</title>
</head>
<body>
    <h1>Test Search Functionality</h1>
    <input type="text" id="searchInput" placeholder="Enter search query">
    <button onclick="performSearch()">Search</button>
    <div id="results"></div>

    <script>
        async function performSearch() {
            const query = document.getElementById('searchInput').value;
            const resultsDiv = document.getElementById('results');
            
            resultsDiv.innerHTML = 'Searching...';
            
            try {
                // First, try to login to get a token
                const loginResponse = await fetch('http://localhost:5001/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: 'user1',
                        password: 'password123'
                    })
                });
                
                if (!loginResponse.ok) {
                    resultsDiv.innerHTML = 'Login failed: ' + await loginResponse.text();
                    return;
                }
                
                const loginData = await loginResponse.json();
                const token = loginData.token;
                
                // Now perform the search
                const searchResponse = await fetch(`http://localhost:5001/api/books/search?query=${encodeURIComponent(query)}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (!searchResponse.ok) {
                    resultsDiv.innerHTML = 'Search failed: ' + await searchResponse.text();
                    return;
                }
                
                const books = await searchResponse.json();
                resultsDiv.innerHTML = `<h2>Found ${books.length} books:</h2>`;
                
                books.forEach(book => {
                    resultsDiv.innerHTML += `
                        <div style="border: 1px solid #ccc; margin: 10px; padding: 10px;">
                            <h3>${book.title}</h3>
                            <p><strong>Author:</strong> ${book.author}</p>
                            <p><strong>Description:</strong> ${book.description || 'No description'}</p>
                        </div>
                    `;
                });
            } catch (error) {
                resultsDiv.innerHTML = 'Error: ' + error.message;
            }
        }
    </script>
</body>
</html>